<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Install in a Single Cluster | LLMariner</title>
<meta name=description content="Install LLMariner in a single Kubernetes cluster."><meta property="og:url" content="https://llmariner.ai/docs/setup/install/single_cluster_production/"><meta property="og:site_name" content="LLMariner"><meta property="og:title" content="Install in a Single Cluster"><meta property="og:description" content="Install LLMariner in a single Kubernetes cluster."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2024-10-25T20:48:13+09:00"><meta itemprop=name content="Install in a Single Cluster"><meta itemprop=description content="Install LLMariner in a single Kubernetes cluster."><meta itemprop=dateModified content="2024-10-25T20:48:13+09:00"><meta itemprop=wordCount content="2230"><meta name=twitter:card content="summary"><meta name=twitter:title content="Install in a Single Cluster"><meta name=twitter:description content="Install LLMariner in a single Kubernetes cluster."><link rel=preload href=/scss/main.min.f5f1bfbe5d5d7a6f0bb1b9d8ae3a3aee20f3a7a4d3e278a18d40b0d46e2b0ddb.css as=style><link href=/scss/main.min.f5f1bfbe5d5d7a6f0bb1b9d8ae3a3aee20f3a7a4d3e278a18d40b0d46e2b0ddb.css rel=stylesheet><script src=https://code.jquery.com/jquery-3.7.1.min.js integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin=anonymous></script><script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-JBN3K7Y529"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JBN3K7Y529")}</script></head><body class=td-page><header><nav class="td-navbar js-navbar-scroll" data-bs-theme=dark><div class="container-fluid flex-column flex-md-row"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_2" viewBox="0 0 426 426"><defs><style>.cls-1{fill:none}.cls-2{fill:#2491eb}.cls-3{fill:#fff}.cls-4{fill:#102c3f}</style></defs><g id="Layer_4"><rect class="cls-1" width="426" height="426"/></g><g id="Layer_1-2" data-name="Layer_1"><g><path class="cls-3" d="M297.78 142.6c-.58-.78-.73-1.54-.75-2.49.1-6.62-.3-28.22.19-34.77.36-1.5 3.4-3.12 5.17-4.29 23.46-14.42 32.1-37.79 13.17-57.48-18.33-21.77-74.32-35.96-118.14-32.11-43.09 1.55-97.3 22.81-99.25 52.59-1.55 18.53 13.46 31.7 28.95 40.28 2.39 1.31 5.2 2.63 4.84 5.73.0 5.84.02 20.42-.02 25.02-.07 1.61-.28 2.3-1.29 3.29-15.69 14.17-34.21 39.77-40.92 64.65-26.6 91.07 58.97 179.78 151.47 157.86 101.16-23.37 134.6-150.45 56.63-218.18l-.07-.09z"/><path class="cls-2" d="M295.05 136.36c-6.98 7.43-15.99 13.84-26.47 18.86 25.74 17.44 42.65 46.92 42.65 80.36.0 53.57-43.43 97-97 97s-97-43.43-97-97c0-33.35 16.83-62.76 42.46-80.22-11.37-5.39-21.01-12.43-28.24-20.63-29.98 23.81-49.21 60.58-49.21 101.85.0 71.8 58.2 130 130 130s130-58.2 130-130c0-40.33-18.36-76.37-47.19-100.21z"/><path class="cls-4" d="M328.22 322.29c2.26 9.28 22.08 15.7 27.56 26.74 11.43 17.87-8.84 37.22-26.58 25.78-9.21-5.77-12.56-16.75-18.27-25.5-3.07-5.09-5.42-6.97-9.88-2.77-19.67 16.58-42.54 24.87-68.13 27.94-1.54.19-3.63.48-4.53 1.54-.85.88-.95 2.29-.64 3.96.56 2.75 1.39 5.54 2.13 8.24 1.08 3.89 2.14 7.73 2.63 11.69 1.59 10.12-3.55 22.67-14.13 25.25-11.45 2.91-22.27-4.78-24.06-16.58-3.76-15.85 17.86-32.59.2-34.5-25.37-3.81-49.39-12.98-69.68-28.64-1.18-.89-2.75-2.08-4.07-2.05-1.47-.08-2.74 1.36-3.58 2.59-7.88 11-15.62 26.79-28.27 32.28-13.22 4.53-26.6-10.3-22.79-23.2 1.49-4.91 4.92-9.41 8.61-12.86 7.37-6.76 15.69-8.23 23.69-15.72 2.93-2.48 2.89-5.82.44-8.61-12.26-16.48-20.13-36.23-23.49-56.51-.51-2.23-.77-5.47-2.6-6.59-3.89-2.56-13.17 3.97-23.23 5.6-10.93 2.71-26.13-7.21-26.02-17.93-.5-13.11 16.04-25.99 31.83-20.82 3.52.69 15.32 7.66 17.66 4.91.88-.89 1-2.9 1.13-4.31 1.68-22.16 9.69-40.84 22.64-57.67 2.95-3.16 2.15-6.87-.94-9.62-14.13-13.06-31.37-10.71-32.06-31.83.23-11.9 13.31-21.57 24.72-18.3 9.61 2.95 19.88 19.48 26.82 27.24 4.28 5.52 6.39 1.56 6.47-3.47.11-2.18.0-4.38-.03-6.56-.18-5.29.97-8.91-2.32-12.32-4.35-4.56-14.08-6.82-21.3-16.79-11.66-16.14-9.9-34.68 3.64-49.08 59.69-57.99 166.35-58.78 223.98 2.58 13.71 17.62 9.88 44.2-10.26 56.44-4.38 2.85-10.32 5.22-11.59 10.72-.57 2.66-2.2 15.99-.5 18.44 1.58 2.49 5.29 2.97 7.15.49 5.61-7.86 9.47-16.84 16.24-23.76 9.24-9.24 24.45-5.21 30.22 5.39 4.16 6.74 1.47 16.87-4.27 22.63-6.46 6.77-16.19 6.77-20.56 13.87-2.22 2.98-2.68 6.78-.19 10.38 6.9 11.29 12.76 21.3 16.83 33.96 6.86 19.21 1.69 38.69 16.61 30.76 3.53-1.54 7.43-3.03 11.22-3.8 12.14-3.09 24.91 2.93 28.49 15.03 1.76 6.25-1.28 12.83-6.08 16.92-8.93 8.27-22.48 7.22-33.02 1.67-9.96-4.57-11.47-1.12-12.86 8.35-2.66 19.7-13.47 36.69-23.43 53.55-.84 1.42-1.67 3.13-1.57 4.69v.16zM255.37 172.65c-4.73-1.2-9.2 1.26-13.84 1.99-5.54 1.28-11.12 2.49-16.77 3.25-15.09 2.06-30.02.48-44.74-3.24-3.57-1-7.36-1.42-10.69.49-27.47 16.28-42.82 49.15-34.71 80.26 2.06 8.06 5.88 15.95 10.9 22.79 74.63 104.21 220.91-27.66 110.04-105.47l-.2-.06zm-65.68-72.44c17.39.68 66.75-.25 86.69-1.01 3.66-.14 6.9-.4 10.37-1.58 8.23-2.85 17.06-8.72 22.57-15.18 8.14-9.47 3.88-19.85-4.65-27.71-31.19-26.75-72.1-37.53-112.62-32.33-27.92 3.81-91.19 31.28-80.66 52.87 4.98 8.33 15.55 19.06 24.6 23.03 3.06 1.17 6.58.96 9.91 1.01 15.65.15 28.01.8 43.66.89h.12zm-55.96 50.81c-1.49.03-3.11 1.28-4.29 2.38-16.62 15.03-27.34 34.45-32.39 55.24-11.92 47.94 7.66 103.54 51.97 128.04 123.31 73.93 249.68-75.84 149.57-185.06-2.96-3.34-5.63-3.99-8.6-.76-2.09 2.01-4.17 4.02-6.25 6.03-1.89 1.89-4.4 3.82-4.29 5.74.08 1.7 1.47 2.83 2.66 3.96 16.81 14.72 27.59 33.1 31.89 52.56 6.32 27.91-1.54 57.55-20.26 80.02-92.83 106.7-253.39-33.94-146.88-136.66.07-2.41-3.46-4.51-5.37-6.36-2.41-1.76-4.48-4.86-7.6-5.12h-.15zm10.66-29.55c12.91 49.6 121.56 47.77 138.36.78-.08-1.08-1.12-1.6-2.78-1.73-44.34-.17-87.73.0-131.3-.06-1.37-.02-3.56.03-4.21.92l-.07.09z"/><path class="cls-1" d="M255.06 172.51c3.11 1 5.1 3.89 7.68 5.87 12.2 9.18 22.72 21.19 27.47 34.59 9.65 25.89 4.17 59.63-16.42 79.2-49.47 48.7-138.36 17.5-141.36-53.5-.51-21.56 10.48-45.01 29-57.42 3.79-2.39 6.89-6.14 11.27-7.25 2.39-.53 5.1.12 7.53.72 14.71 3.7 29.65 5.25 44.74 3.16 5.77-.79 11.48-2.04 17.15-3.36 4.2-.7 8.58-2.83 12.78-2.08l.16.04zM253.92 217.15c-5.98 5.08-11.51 13.48-9.39 21.64 2.63 11.24 15.82 17.72 26.77 13.38 11.89-4.27 15.5-19.61 7.45-29.2-5.5-6.95-17.27-11.5-24.68-5.94l-.15.11zM157.76 215.76c.73 1.63 3.03 2.37 4.11 3.83 3.84 4.02.04 10.35-4.72 11.56-2.8.8-6.03-1.11-7.71-3.69-.91-1.06-1.58-4.08-3.32-3.24-2.49 2.4-2.98 6.35-3.1 9.73-.16 22.97 30.48 26.53 38.81 6.32 4.3-11.15-4.19-22.18-14.85-25.35-2.13-.78-8.67-1.52-9.24.77v.08zm55.66 46.66c11.38.44 23.08-10.59 22.79-22.87-.5-5.19-7.28-9.61-11.86-6.63-2.51 1.94-3.32 6.23-5.23 8.83-2.44 3.85-8.81 3.79-11.32.07-1.87-2.44-2.4-6.42-4.56-8.34-2.61-2.41-7.59-1.5-9.91.91-2.13 2.07-2.78 5.35-2.58 8.26.68 11.08 11.22 19.81 22.46 19.76h.2z"/><path class="cls-1" d="M130.11 155.2c3.26-4.15 5.35-3.62 8.84-.31 2.31 2.1 5.05 4.13 7.21 6.44 1.89 1.98.89 4.33-.89 6.15-3.73 4.16-7.59 8.22-11.4 12.5-11.73 13.2-19.15 30.13-21.28 47.31-5.87 47.02 22.26 88.14 67.08 103.74 35.43 13.95 80.64 5.14 108.39-24.7 11.27-12.45 20.44-26.88 24.75-43.06 7.53-29.79 2.72-62.48-20.45-84.92-4.08-4.31-8.43-8.22-12.26-12.74-2.34-3.17.92-5.59 3.5-8.11 1.85-1.79 3.7-3.57 5.55-5.35 1.86-1.82 4.31-4.52 6.77-2.11 9.58 12.05 19.26 24.15 26.69 37.6 30.94 56.42 1.86 132.89-56.2 157.48-31.35 15.05-66.94 15.14-99.04.85-35.74-14.59-62.55-43.95-70.7-81.16"/><path class="cls-4" d="M213.22 262.42c-11.24.05-21.78-8.68-22.46-19.76-.2-2.91.45-6.19 2.58-8.26 2.32-2.41 7.3-3.32 9.91-.91 2.17 1.92 2.69 5.9 4.56 8.34 2.51 3.72 8.88 3.78 11.32-.07 1.92-2.6 2.72-6.89 5.23-8.83 4.58-2.99 11.35 1.44 11.86 6.62.28 12.29-11.41 23.31-22.79 22.87h-.2z"/><path class="cls-3" d="M254.27 217.19c4.9-.94 10.11 4.79 8.25 9.59-.66 1.93-1.85 4.11-3.76 4.96-2.74.93-7.01-.47-8.16-3.28-.92-3.73-.33-9.42 3.49-11.22l.17-.06z"/><path class="cls-2" d="M195.48 62.7c-.11-2.8.2-5.67.48-8.47.37-3.4.72-7.12 2.6-10.02 2.07-3.27 6.23-5.17 10.03-4.41 8.61 2.16 7.02 13.36 7.15 20.23-1.12 15.67 7.22 6.68 16 10.39 5.24 2.35 4.12 9.37.69 12.85-6.99 7.97-23.36 10.29-31.51 1.67-5.8-5.63-5.22-14.71-5.43-22.05v-.18z"/></g><circle class="cls-4" cx="162.5" cy="234.5" r="19.5"/><circle class="cls-4" cx="262.5" cy="234.5" r="19.5"/><circle class="cls-3" cx="254.5" cy="224.5" r="7.5"/><circle class="cls-3" cx="154.5" cy="223.5" r="7.5"/></g></svg></span><span class=navbar-brand__name>LLMariner</span></a><div class="td-navbar-nav-scroll ms-md-auto" id=main_navbar><ul class=navbar-nav><li class=nav-item><a class="nav-link active" href=/docs/><span>Documentation</span></a></li><li class=nav-item><a class=nav-link href=https://github.com/llmariner/llmariner target=_blank rel=noopener><span>GitHub</span><sup><i class="ps-1 fa-solid fa-up-right-from-square fa-xs" aria-hidden=true></i></sup></a></li><li class="td-light-dark-menu nav-item dropdown"><svg class="d-none"><symbol id="check2" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5.0 010 .708l-7 7a.5.5.0 01-.708.0l-3.5-3.5a.5.5.0 11.708-.708L6.5 10.293l6.646-6.647a.5.5.0 01.708.0z"/></symbol><symbol id="circle-half" viewBox="0 0 16 16"><path d="M8 15A7 7 0 108 1v14zm0 1A8 8 0 118 0a8 8 0 010 16z"/></symbol><symbol id="moon-stars-fill" viewBox="0 0 16 16"><path d="M6 .278a.768.768.0 01.08.858 7.208 7.208.0 00-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527.0 1.04-.055 1.533-.16a.787.787.0 01.81.316.733.733.0 01-.031.893A8.349 8.349.0 018.344 16C3.734 16 0 12.286.0 7.71.0 4.266 2.114 1.312 5.124.06A.752.752.0 016 .278z"/><path d="M10.794 3.148a.217.217.0 01.412.0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217.0 010 .412l-1.162.387A1.734 1.734.0 0011.593 7.69l-.387 1.162a.217.217.0 01-.412.0l-.387-1.162A1.734 1.734.0 009.31 6.593l-1.162-.387a.217.217.0 010-.412l1.162-.387a1.734 1.734.0 001.097-1.097l.387-1.162zM13.863.099a.145.145.0 01.274.0l.258.774c.115.346.386.617.732.732l.774.258a.145.145.0 010 .274l-.774.258a1.156 1.156.0 00-.732.732l-.258.774a.145.145.0 01-.274.0l-.258-.774a1.156 1.156.0 00-.732-.732l-.774-.258a.145.145.0 010-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"/></symbol><symbol id="sun-fill" viewBox="0 0 16 16"><path d="M8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 0zm0 13a.5.5.0 01.5.5v2a.5.5.0 01-1 0v-2A.5.5.0 018 13zm8-5a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2a.5.5.0 01.5.5zM3 8a.5.5.0 01-.5.5h-2a.5.5.0 010-1h2A.5.5.0 013 8zm10.657-5.657a.5.5.0 010 .707l-1.414 1.415a.5.5.0 11-.707-.708l1.414-1.414a.5.5.0 01.707.0zm-9.193 9.193a.5.5.0 010 .707L3.05 13.657a.5.5.0 01-.707-.707l1.414-1.414a.5.5.0 01.707.0zm9.193 2.121a.5.5.0 01-.707.0l-1.414-1.414a.5.5.0 01.707-.707l1.414 1.414a.5.5.0 010 .707zM4.464 4.465a.5.5.0 01-.707.0L2.343 3.05a.5.5.0 11.707-.707l1.414 1.414a.5.5.0 010 .708z"/></symbol></svg>
<button class="btn btn-link nav-link dropdown-toggle d-flex align-items-center" id=bd-theme type=button aria-expanded=false data-bs-toggle=dropdown data-bs-display=static aria-label="Toggle theme (auto)"><svg class="bi my-1 theme-icon-active"><use href="#circle-half"/></svg></button><ul class="dropdown-menu dropdown-menu-end" aria-labelledby=bd-theme-text><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=light aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#sun-fill"/></svg>
Light<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center" data-bs-theme-value=dark aria-pressed=false>
<svg class="bi me-2 opacity-50"><use href="#moon-stars-fill"/></svg>
Dark<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li><li><button type=button class="dropdown-item d-flex align-items-center active" data-bs-theme-value=auto aria-pressed=true>
<svg class="bi me-2 opacity-50"><use href="#circle-half"/></svg>
Auto<svg class="bi ms-auto d-none"><use href="#check2"/></svg></button></li></ul></li></ul></div><div class="d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.43245d97f5b36d61f5a88d2f1dee228a.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.43245d97f5b36d61f5a88d2f1dee228a.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ms-3 fas fa-bars" type=button data-bs-toggle=collapse data-bs-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="td-sidebar-nav collapse" id=td-section-nav><ul class="td-sidebar-nav__section pe-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ title="Welcome to LLMariner Documentation!" class="align-left ps-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docssetup-li><a href=/docs/setup/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docssetup><span>Getting Started</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docssetupinstall-li><a href=/docs/setup/install/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docssetupinstall><span>Installation</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docssetupinstallplayground-li><a href=/docs/setup/install/playground/ title="Set up a Playground" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docssetupinstallplayground><span>Playground</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docssetupinstallcpu-only-li><a href=/docs/setup/install/cpu-only/ title="Set up a Playground (CPU-only)" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docssetupinstallcpu-only><span>Playground (CPU)</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docssetupinstallsingle_cluster_production-li><a href=/docs/setup/install/single_cluster_production/ title="Install in a Single Cluster" class="align-left ps-0 active td-sidebar-link td-sidebar-link__page" id=m-docssetupinstallsingle_cluster_production><span class=td-sidebar-nav-active-item>Standalone</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docssetupinstallmulti_cluster_production-li><a href=/docs/setup/install/multi_cluster_production/ title="Install across Multiple Clusters" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docssetupinstallmulti_cluster_production><span>Multicluster</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docssetupinstallhosted_control_plane-li><a href=/docs/setup/install/hosted_control_plane/ title="Hosted Control Plane" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docssetupinstallhosted_control_plane><span>Hosting Service</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docssetuptutorials-li><a href=/docs/setup/tutorials/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docssetuptutorials><span>Tutorials</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsfeatures-li><a href=/docs/features/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsfeatures><span>Features</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesinference-li><a href=/docs/features/inference/ title="Inference with Open Models" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesinference><span>Inference</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesmodels-li><a href=/docs/features/models/ title="Supported Open Models" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesmodels><span>Supported Models</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesrag-li><a href=/docs/features/rag/ title="Retrieval-Augmented Generation (RAG)" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesrag><span>RAG</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesfine_tuning-li><a href=/docs/features/fine_tuning/ title="Model Fine-tuning" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesfine_tuning><span>Fine-tuning</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturestraining-li><a href=/docs/features/training/ title="General-purpose Training" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturestraining><span>Training</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesjupyter_notebook-li><a href=/docs/features/jupyter_notebook/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesjupyter_notebook><span>Jupyter Notebook</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesvisibility-li><a href=/docs/features/visibility/ title="API and GPU Usage Visibility" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesvisibility><span>API/GPU Visibility</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesuser_management-li><a href=/docs/features/user_management/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesuser_management><span>User Management</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsfeaturesaccess_control-li><a href=/docs/features/access_control/ title="Access Control with Organizations and Projects" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsfeaturesaccess_control><span>Access Control</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsintegration-li><a href=/docs/integration/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsintegration><span>Integration</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsintegrationopenwebui-li><a href=/docs/integration/openwebui/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsintegrationopenwebui><span>Open WebUI</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsintegrationcontinue-li><a href=/docs/integration/continue/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsintegrationcontinue><span>Continue</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsintegrationmlflow-li><a href=/docs/integration/mlflow/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsintegrationmlflow><span>MLflow</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsintegrationwandb-li><a href=/docs/integration/wandb/ title="Weights & Biases (W&amp;B)" class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsintegrationwandb><span>Weights & Biases</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docsdev-li><a href=/docs/dev/ class="align-left ps-0 td-sidebar-link td-sidebar-link__section" id=m-docsdev><span>Development</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdevarchitecture-li><a href=/docs/dev/architecture/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevarchitecture><span>Technical Details</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docsdevroadmap-li><a href=/docs/dev/roadmap/ class="align-left ps-0 td-sidebar-link td-sidebar-link__page" id=m-docsdevroadmap><span>Roadmap</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class=td-toc><nav id=TableOfContents><ul><li><a href=#eks-installation>EKS Installation</a><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#step-1-provision-an-eks-cluster>Step 1. Provision an EKS cluster</a></li><li><a href=#step-2-create-an-rds-instance>Step 2. Create an RDS instance</a></li><li><a href=#step-3-create-an-s3-bucket>Step 3. Create an S3 bucket</a></li><li><a href=#step-4-install-milvus>Step 4. Install Milvus</a></li><li><a href=#step-5-install-llmariner>Step 5. Install LLMariner</a></li><li><a href=#step-6-verify-the-installation>Step 6. Verify the installation</a></li><li><a href=#optional-monitor-gpu-utilization>Optional: Monitor GPU utilization</a></li><li><a href=#optional-enable-tls>Optional: Enable TLS</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 ps-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=/docs/>Documentation</a></li><li class=breadcrumb-item><a href=/docs/setup/>Getting Started</a></li><li class=breadcrumb-item><a href=/docs/setup/install/>Installation</a></li><li class="breadcrumb-item active" aria-current=page>Standalone</li></ol></nav><div class=td-content><h1>Install in a Single Cluster</h1><div class=lead>Install LLMariner in a single Kubernetes cluster.</div><header class=article-meta></header><p>We provide a Helm chart for installing LLMariner. You can obtain the Helm chart from our repository and install.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Logout of helm registry to perform an unauthenticated pull against the public ECR</span>
</span></span><span class=line><span class=cl>helm registry <span class=nb>logout</span> public.ecr.aws
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm upgrade --install <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace &lt;namespace&gt; <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  llmariner oci://public.ecr.aws/cloudnatix/llmariner-charts/llmariner <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --values &lt;values.yaml&gt;
</span></span></code></pre></div><p>Once installation completes, you can interact with the API endpoint using the <a href=https://github.com/openai/openai-python>OpenAI Python library</a>, running our CLI, or directly hitting the endpoint. To download the CLI, run:</p><ul class="nav nav-tabs" id=tabs-0 role=tablist><li class=nav-item><button class="nav-link disabled" id=tabs-00-00-tab data-bs-toggle=tab data-bs-target=#tabs-00-00 role=tab aria-controls=tabs-00-00 aria-selected=false>
<strong>Install From</strong>:</button></li><li class=nav-item><button class="nav-link active" id=tabs-00-01-tab data-bs-toggle=tab data-bs-target=#tabs-00-01 role=tab data-td-tp-persist=script aria-controls=tabs-00-01 aria-selected=true>
Script</button></li><li class=nav-item><button class=nav-link id=tabs-00-02-tab data-bs-toggle=tab data-bs-target=#tabs-00-02 role=tab data-td-tp-persist=homebrew aria-controls=tabs-00-02 aria-selected=false>
Homebrew</button></li><li class=nav-item><button class=nav-link id=tabs-00-03-tab data-bs-toggle=tab data-bs-target=#tabs-00-03 role=tab data-td-tp-persist=go aria-controls=tabs-00-03 aria-selected=false>
Go</button></li><li class=nav-item><button class=nav-link id=tabs-00-04-tab data-bs-toggle=tab data-bs-target=#tabs-00-04 role=tab data-td-tp-persist=binary aria-controls=tabs-00-04 aria-selected=false>
Binary</button></li></ul><div class=tab-content id=tabs-0-content><div class="tab-body tab-pane fade" id=tabs-00-00 role=tabpanel aria-labelled-by=tabs-00-00-tab tabindex=0></div><div class="tab-body tab-pane fade show active" id=tabs-00-01 role=tabpanel aria-labelled-by=tabs-00-01-tab tabindex=0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl --silent https://llmariner.ai/get-cli <span class=p>|</span> bash
</span></span><span class=line><span class=cl>mv llma &lt;your/PATH&gt;
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-02 role=tabpanel aria-labelled-by=tabs-00-02-tab tabindex=0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew install llmariner/tap/llma
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-03 role=tabpanel aria-labelled-by=tabs-00-03-tab tabindex=0><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go install github.com/llmariner/llmariner/cli/cmd@latest
</span></span></code></pre></div></div><div class="tab-body tab-pane fade" id=tabs-00-04 role=tabpanel aria-labelled-by=tabs-00-04-tab tabindex=0><p>Download the binary from <a href=https://github.com/llmariner/llmariner/releases/latest>GitHub Release Page</a>.</p></div></div><h2 id=eks-installation>EKS Installation<a class=td-heading-self-link href=#eks-installation aria-label="Heading self-link"></a></h2><p>Let's go through the details of the installation. Here we use EKS as a target K8s cluster, but it can be AKS, GKE, or any other K8s cluster.</p><h3 id=prerequisites>Prerequisites<a class=td-heading-self-link href=#prerequisites aria-label="Heading self-link"></a></h3><p>LLMariner requires the following resources:</p><ul><li><a href=https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/latest/index.html>Nvidia GPU Operator</a></li><li>Ingress controller (to route API requests)</li><li>SQL database (to store jobs/models/files metadata)</li><li>S3-compatible object store (to store training files and models)</li><li><a href=https://milvus.io/>Milvus</a> (for RAG, optional)</li></ul><p>LLMariner can process inference requests on CPU nodes, but it can be best used with GPU nodes. Nvidia GPU Operator is required to install the device plugin and make GPUs visible in the K8s cluster.</p><p>Preferably the ingress controller should have a DNS name or an IP that is reachable from the outside of the EKS cluster. If not, you can rely on port-forwarding to reach the API endpoints.</p><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>When port-forwarding is used, the same port needs to be used consistently as the port number will be included the OIDC issuer URL. We will explain details later.</div><p>You can provision RDS and S3 in AWS, or you can deploy Postgres and <a href=https://min.io/>MinIO</a> inside your EKS cluster. The following permissions are required for S3:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Version&#34;</span><span class=p>:</span> <span class=s2>&#34;2012-10-17&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;Statement&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;Effect&#34;</span><span class=p>:</span> <span class=s2>&#34;Allow&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nt>&#34;Action&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>         <span class=s2>&#34;s3:PutObject&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=s2>&#34;s3:GetObject&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=s2>&#34;s3:DeleteObject&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=s2>&#34;s3:ListBucket&#34;</span>
</span></span><span class=line><span class=cl>       <span class=p>],</span>
</span></span><span class=line><span class=cl>       <span class=nt>&#34;Resource&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>         <span class=s2>&#34;arn:aws:s3:::&lt;bucket name&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>         <span class=s2>&#34;arn:aws:s3:::&lt;bucket name&gt;/*&#34;</span>
</span></span><span class=line><span class=cl>       <span class=p>]</span>
</span></span><span class=line><span class=cl>     <span class=p>}</span>
</span></span><span class=line><span class=cl>   <span class=p>]</span>
</span></span><span class=line><span class=cl> <span class=p>}</span>
</span></span></code></pre></div><p>The rest of the section go through concrete steps to create an EKS cluster, create necessary resources, and install LLMariner. You can skip some of the steps if you have already made necessary installation/setup.</p><h3 id=step-1-provision-an-eks-cluster>Step 1. Provision an EKS cluster<a class=td-heading-self-link href=#step-1-provision-an-eks-cluster aria-label="Heading self-link"></a></h3><h4 id=step-11-create-a-new-cluster-with-karpenter>Step 1.1. Create a new cluster with Karpenter<a class=td-heading-self-link href=#step-11-create-a-new-cluster-with-karpenter aria-label="Heading self-link"></a></h4><p>Follow the <a href=https://karpenter.sh/docs/getting-started/getting-started-with-karpenter/>Karpenter getting started guide</a> and create an EKS cluster and add Karpenter. The following is the installation step copied from the page (with slight simplification).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>CLUSTER_NAME</span><span class=o>=</span><span class=s2>&#34;llmariner-demo&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>AWS_DEFAULT_REGION</span><span class=o>=</span><span class=s2>&#34;us-east-1&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>AWS_ACCOUNT_ID</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>aws sts get-caller-identity --query Account --output text<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>KARPENTER_NAMESPACE</span><span class=o>=</span><span class=s2>&#34;kube-system&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>KARPENTER_VERSION</span><span class=o>=</span><span class=s2>&#34;1.0.1&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>K8S_VERSION</span><span class=o>=</span><span class=s2>&#34;1.30&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TEMPOUT</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>mktemp<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -fsSL https://raw.githubusercontent.com/aws/karpenter-provider-aws/v<span class=s2>&#34;</span><span class=si>${</span><span class=nv>KARPENTER_VERSION</span><span class=si>}</span><span class=s2>&#34;</span>/website/content/en/preview/getting-started/getting-started-with-karpenter/cloudformation.yaml  &gt; <span class=s2>&#34;</span><span class=si>${</span><span class=nv>TEMPOUT</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=o>&amp;&amp;</span> aws cloudformation deploy <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --stack-name <span class=s2>&#34;Karpenter-</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --template-file <span class=s2>&#34;</span><span class=si>${</span><span class=nv>TEMPOUT</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --capabilities CAPABILITY_NAMED_IAM <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --parameter-overrides <span class=s2>&#34;ClusterName=</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>eksctl create cluster -f - <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>---
</span></span></span><span class=line><span class=cl><span class=s>apiVersion: eksctl.io/v1alpha5
</span></span></span><span class=line><span class=cl><span class=s>kind: ClusterConfig
</span></span></span><span class=line><span class=cl><span class=s>metadata:
</span></span></span><span class=line><span class=cl><span class=s>  name: ${CLUSTER_NAME}
</span></span></span><span class=line><span class=cl><span class=s>  region: ${AWS_DEFAULT_REGION}
</span></span></span><span class=line><span class=cl><span class=s>  version: &#34;${K8S_VERSION}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  tags:
</span></span></span><span class=line><span class=cl><span class=s>    karpenter.sh/discovery: ${CLUSTER_NAME}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>iam:
</span></span></span><span class=line><span class=cl><span class=s>  withOIDC: true
</span></span></span><span class=line><span class=cl><span class=s>  podIdentityAssociations:
</span></span></span><span class=line><span class=cl><span class=s>  - namespace: &#34;${KARPENTER_NAMESPACE}&#34;
</span></span></span><span class=line><span class=cl><span class=s>    serviceAccountName: karpenter
</span></span></span><span class=line><span class=cl><span class=s>    roleName: ${CLUSTER_NAME}-karpenter
</span></span></span><span class=line><span class=cl><span class=s>    permissionPolicyARNs:
</span></span></span><span class=line><span class=cl><span class=s>    - arn:aws:iam::${AWS_ACCOUNT_ID}:policy/KarpenterControllerPolicy-${CLUSTER_NAME}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>iamIdentityMappings:
</span></span></span><span class=line><span class=cl><span class=s>- arn: &#34;arn:aws:iam::${AWS_ACCOUNT_ID}:role/KarpenterNodeRole-${CLUSTER_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  username: system:node:{{EC2PrivateDNSName}}
</span></span></span><span class=line><span class=cl><span class=s>  groups:
</span></span></span><span class=line><span class=cl><span class=s>  - system:bootstrappers
</span></span></span><span class=line><span class=cl><span class=s>  - system:nodes
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>managedNodeGroups:
</span></span></span><span class=line><span class=cl><span class=s>- instanceType: m5.large
</span></span></span><span class=line><span class=cl><span class=s>  amiFamily: AmazonLinux2
</span></span></span><span class=line><span class=cl><span class=s>  name: ${CLUSTER_NAME}-ng
</span></span></span><span class=line><span class=cl><span class=s>  desiredCapacity: 2
</span></span></span><span class=line><span class=cl><span class=s>  minSize: 1
</span></span></span><span class=line><span class=cl><span class=s>  maxSize: 10
</span></span></span><span class=line><span class=cl><span class=s>addons:
</span></span></span><span class=line><span class=cl><span class=s>- name: eks-pod-identity-agent
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Create the service linked role if it does not exist. Ignore an already-exists error.</span>
</span></span><span class=line><span class=cl>aws iam create-service-linked-role --aws-service-name spot.amazonaws.com <span class=o>||</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Logout of helm registry to perform an unauthenticated pull against the public ECR.</span>
</span></span><span class=line><span class=cl>helm registry <span class=nb>logout</span> public.ecr.aws
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Deploy Karpenter.</span>
</span></span><span class=line><span class=cl>helm upgrade --install --wait <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace <span class=s2>&#34;</span><span class=si>${</span><span class=nv>KARPENTER_NAMESPACE</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  karpenter oci://public.ecr.aws/karpenter/karpenter <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --version <span class=s2>&#34;</span><span class=si>${</span><span class=nv>KARPENTER_VERSION</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set <span class=s2>&#34;settings.clusterName=</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set <span class=s2>&#34;settings.interruptionQueue=</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set controller.resources.requests.cpu<span class=o>=</span><span class=m>1</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set controller.resources.requests.memory<span class=o>=</span>1Gi <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set controller.resources.limits.cpu<span class=o>=</span><span class=m>1</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set controller.resources.limits.memory<span class=o>=</span>1Gi
</span></span></code></pre></div><h4 id=step-12-provision-gpu-nodes>Step 1.2. Provision GPU nodes<a class=td-heading-self-link href=#step-12-provision-gpu-nodes aria-label="Heading self-link"></a></h4><p>Once Karpenter is installed, we need to create an <code>EC2NodeClass</code> and a <code>NodePool</code> so that GPU nodes are provisioned. We configure <code>blockDeviceMappings</code> in the <code>EC2NodeClass</code> definition so that nodes have sufficient local storage to store model files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GPU_AMI_ID</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span>aws ssm get-parameter --name /aws/service/eks/optimized-ami/<span class=si>${</span><span class=nv>K8S_VERSION</span><span class=si>}</span>/amazon-linux-2-gpu/recommended/image_id --query Parameter.Value --output text<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt; EOF | envsubst | kubectl apply -f -
</span></span></span><span class=line><span class=cl><span class=s>apiVersion: karpenter.sh/v1
</span></span></span><span class=line><span class=cl><span class=s>kind: NodePool
</span></span></span><span class=line><span class=cl><span class=s>metadata:
</span></span></span><span class=line><span class=cl><span class=s>  name: default
</span></span></span><span class=line><span class=cl><span class=s>spec:
</span></span></span><span class=line><span class=cl><span class=s>  template:
</span></span></span><span class=line><span class=cl><span class=s>    spec:
</span></span></span><span class=line><span class=cl><span class=s>      requirements:
</span></span></span><span class=line><span class=cl><span class=s>      - key: kubernetes.io/arch
</span></span></span><span class=line><span class=cl><span class=s>        operator: In
</span></span></span><span class=line><span class=cl><span class=s>        values: [&#34;amd64&#34;]
</span></span></span><span class=line><span class=cl><span class=s>      - key: kubernetes.io/os
</span></span></span><span class=line><span class=cl><span class=s>        operator: In
</span></span></span><span class=line><span class=cl><span class=s>        values: [&#34;linux&#34;]
</span></span></span><span class=line><span class=cl><span class=s>      - key: karpenter.sh/capacity-type
</span></span></span><span class=line><span class=cl><span class=s>        operator: In
</span></span></span><span class=line><span class=cl><span class=s>        values: [&#34;on-demand&#34;]
</span></span></span><span class=line><span class=cl><span class=s>      - key: karpenter.k8s.aws/instance-family
</span></span></span><span class=line><span class=cl><span class=s>        operator: In
</span></span></span><span class=line><span class=cl><span class=s>        values: [&#34;g5&#34;]
</span></span></span><span class=line><span class=cl><span class=s>      nodeClassRef:
</span></span></span><span class=line><span class=cl><span class=s>        group: karpenter.k8s.aws
</span></span></span><span class=line><span class=cl><span class=s>        kind: EC2NodeClass
</span></span></span><span class=line><span class=cl><span class=s>        name: default
</span></span></span><span class=line><span class=cl><span class=s>      expireAfter: 720h
</span></span></span><span class=line><span class=cl><span class=s>  disruption:
</span></span></span><span class=line><span class=cl><span class=s>    consolidationPolicy: WhenEmptyOrUnderutilized
</span></span></span><span class=line><span class=cl><span class=s>    consolidateAfter: 1m
</span></span></span><span class=line><span class=cl><span class=s>---
</span></span></span><span class=line><span class=cl><span class=s>apiVersion: karpenter.k8s.aws/v1
</span></span></span><span class=line><span class=cl><span class=s>kind: EC2NodeClass
</span></span></span><span class=line><span class=cl><span class=s>metadata:
</span></span></span><span class=line><span class=cl><span class=s>  name: default
</span></span></span><span class=line><span class=cl><span class=s>spec:
</span></span></span><span class=line><span class=cl><span class=s>  amiFamily: AL2
</span></span></span><span class=line><span class=cl><span class=s>  role: &#34;KarpenterNodeRole-${CLUSTER_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  subnetSelectorTerms:
</span></span></span><span class=line><span class=cl><span class=s>  - tags:
</span></span></span><span class=line><span class=cl><span class=s>      karpenter.sh/discovery: &#34;${CLUSTER_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  securityGroupSelectorTerms:
</span></span></span><span class=line><span class=cl><span class=s>  - tags:
</span></span></span><span class=line><span class=cl><span class=s>      karpenter.sh/discovery: &#34;${CLUSTER_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  amiSelectorTerms:
</span></span></span><span class=line><span class=cl><span class=s>  - id: &#34;${GPU_AMI_ID}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  blockDeviceMappings:
</span></span></span><span class=line><span class=cl><span class=s>  - deviceName: /dev/xvda
</span></span></span><span class=line><span class=cl><span class=s>    ebs:
</span></span></span><span class=line><span class=cl><span class=s>      deleteOnTermination: true
</span></span></span><span class=line><span class=cl><span class=s>      encrypted: true
</span></span></span><span class=line><span class=cl><span class=s>      volumeSize: 256Gi
</span></span></span><span class=line><span class=cl><span class=s>      volumeType: gp3
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></div><h4 id=step-13-install-nvidia-gpu-operator>Step 1.3. Install Nvidia GPU Operator<a class=td-heading-self-link href=#step-13-install-nvidia-gpu-operator aria-label="Heading self-link"></a></h4><p>Nvidia GPU Operator is required to install the device plugin and make GPU resources visible in the K8s cluster. Run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add nvidia https://helm.ngc.nvidia.com/nvidia
</span></span><span class=line><span class=cl>helm repo update
</span></span><span class=line><span class=cl>helm upgrade --install --wait <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace nvidia <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  gpu-operator nvidia/gpu-operator <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set cdi.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set driver.enabled<span class=o>=</span><span class=nb>false</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set toolkit.enabled<span class=o>=</span><span class=nb>false</span>
</span></span></code></pre></div><h4 id=step-14-install-an-ingress-controller>Step 1.4. Install an ingress controller<a class=td-heading-self-link href=#step-14-install-an-ingress-controller aria-label="Heading self-link"></a></h4><p>An ingress controller is required to route HTTP/HTTPS requests to the LLMariner components. Any ingress controller works, and you can skip this step if your EKS cluster already has an ingress controller.</p><p>Here is an example that installs <a href=https://konghq.com/>Kong</a> and make the ingress controller reachable via AWS loadbalancer:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add kong https://charts.konghq.com
</span></span><span class=line><span class=cl>helm repo update
</span></span><span class=line><span class=cl>helm upgrade --install --wait <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace kong <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  kong-proxy kong/kong <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set proxy.annotations.service.beta.kubernetes.io/aws-load-balancer-connection-idle-timeout<span class=o>=</span><span class=m>300</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set ingressController.installCRDs<span class=o>=</span><span class=nb>false</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set <span class=nv>fullnameOverride</span><span class=o>=</span><span class=nb>false</span>
</span></span></code></pre></div><h3 id=step-2-create-an-rds-instance>Step 2. Create an RDS instance<a class=td-heading-self-link href=#step-2-create-an-rds-instance aria-label="Heading self-link"></a></h3><p>We will create an RDS in the same VPC as the EKS cluster so that it can be reachable from the LLMariner components. Here is an example command for creating a DB subnet group and an RDS instance.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>DB_SUBNET_GROUP_NAME</span><span class=o>=</span><span class=s2>&#34;llmariner-demo-db-subnet&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EKS_SUBNET_IDS</span><span class=o>=</span><span class=k>$(</span>aws eks describe-cluster --name <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>|</span> jq <span class=s1>&#39;.cluster.resourcesVpcConfig.subnetIds | join(&#34; &#34;)&#39;</span> --raw-output<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EKS_SUBNET_ID0</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=si>${</span><span class=nv>EKS_SUBNET_IDS</span><span class=si>}</span> <span class=p>|</span> cut -d<span class=s1>&#39; &#39;</span> -f1<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EKS_SUBNET_ID1</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=si>${</span><span class=nv>EKS_SUBNET_IDS</span><span class=si>}</span> <span class=p>|</span> cut -d<span class=s1>&#39; &#39;</span> -f2<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>aws rds create-db-subnet-group <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --db-subnet-group-name <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DB_SUBNET_GROUP_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --db-subnet-group-description <span class=s2>&#34;LLMariner Demo&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --subnet-ids <span class=s2>&#34;</span><span class=si>${</span><span class=nv>EKS_SUBNET_ID0</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>EKS_SUBNET_ID1</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>DB_INSTANCE_ID</span><span class=o>=</span><span class=s2>&#34;llmariner-demo&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_USER</span><span class=o>=</span><span class=s2>&#34;admin_user&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_PASSWORD</span><span class=o>=</span><span class=s2>&#34;secret_password&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>EKS_SECURITY_GROUP_ID</span><span class=o>=</span><span class=k>$(</span>aws eks describe-cluster --name <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>|</span> jq <span class=s1>&#39;.cluster.resourcesVpcConfig.clusterSecurityGroupId&#39;</span> --raw-output<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>aws rds create-db-instance <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --db-instance-identifier <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DB_INSTANCE_ID</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --db-instance-class db.t3.small <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --engine postgres <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --allocated-storage <span class=m>10</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --storage-encrypted <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --master-username <span class=s2>&#34;</span><span class=si>${</span><span class=nv>POSTGRES_USER</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --master-user-password <span class=s2>&#34;</span><span class=si>${</span><span class=nv>POSTGRES_PASSWORD</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --vpc-security-group-ids <span class=s2>&#34;</span><span class=si>${</span><span class=nv>EKS_SECURITY_GROUP_ID</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --db-subnet-group-name <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DB_SUBNET_GROUP_NAME</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>You can run the following command to check the provisioning status.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws rds describe-db-instances --db-instance-identifier <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DB_INSTANCE_ID</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>|</span> jq <span class=s1>&#39;.DBInstances.[].DBInstanceStatus&#39;</span>
</span></span></code></pre></div><p>Once the RDS instance is fully provisioned and its status becomes <code>available</code>, obtain the endpoint information for later use.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_ADDR</span><span class=o>=</span><span class=k>$(</span>aws rds describe-db-instances --db-instance-identifier <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DB_INSTANCE_ID</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>|</span> jq <span class=s1>&#39;.DBInstances.[].Endpoint.Address&#39;</span> --raw-output<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_PORT</span><span class=o>=</span><span class=k>$(</span>aws rds describe-db-instances --db-instance-identifier <span class=s2>&#34;</span><span class=si>${</span><span class=nv>DB_INSTANCE_ID</span><span class=si>}</span><span class=s2>&#34;</span> <span class=p>|</span> jq <span class=s1>&#39;.DBInstances.[].Endpoint.Port&#39;</span> --raw-output<span class=k>)</span>
</span></span></code></pre></div><p>You can verify if the DB instance is reachable from the EKS cluster by running the <code>psql</code> command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl run psql --image jbergknoff/postgresql-client --env<span class=o>=</span><span class=s2>&#34;PGPASSWORD=</span><span class=si>${</span><span class=nv>POSTGRES_PASSWORD</span><span class=si>}</span><span class=s2>&#34;</span> -- -h <span class=s2>&#34;</span><span class=si>${</span><span class=nv>POSTGRES_ADDR</span><span class=si>}</span><span class=s2>&#34;</span> -U <span class=s2>&#34;</span><span class=si>${</span><span class=nv>POSTGRES_USER</span><span class=si>}</span><span class=s2>&#34;</span> -p <span class=s2>&#34;</span><span class=si>${</span><span class=nv>POSTGRES_PORT</span><span class=si>}</span><span class=s2>&#34;</span> -d template1 -c <span class=s2>&#34;select now();&#34;</span>
</span></span><span class=line><span class=cl>kubectl logs psql
</span></span><span class=line><span class=cl>kubectl delete pods psql
</span></span></code></pre></div><p>If <code>psql</code> can successfully connect to the RDS instance, create a K8s secret in the <code>llmariner</code> namespace so that later LLMariner can retrieve the database password from the secret.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LLMARINER_NAMESPACE</span><span class=o>=</span>llmariner
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>POSTGRES_SECRET_NAME</span><span class=o>=</span>postgres
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>kubectl create namespace <span class=s2>&#34;</span><span class=si>${</span><span class=nv>LLMARINER_NAMESPACE</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>kubectl create secret generic -n <span class=s2>&#34;</span><span class=si>${</span><span class=nv>LLMARINER_NAMESPACE</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=si>${</span><span class=nv>POSTGRES_SECRET_NAME</span><span class=si>}</span><span class=s2>&#34;</span> --from-literal<span class=o>=</span><span class=nv>password</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>POSTGRES_PASSWORD</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></div><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>LLMariner will create additional databases on the fly for each API service (e.g., <code>job_manager</code>, <code>model_manager</code>). You can see all created databases by running <code>SELECT count(datname) FROM pg_database;</code>.</div><h3 id=step-3-create-an-s3-bucket>Step 3. Create an S3 bucket<a class=td-heading-self-link href=#step-3-create-an-s3-bucket aria-label="Heading self-link"></a></h3><p>We will create an S3 bucket where model files are stored. Here is an example</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Please change the bucket name to something else.</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>S3_BUCKET_NAME</span><span class=o>=</span><span class=s2>&#34;llmariner-demo&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>S3_REGION</span><span class=o>=</span><span class=s2>&#34;us-east-1&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>aws s3api create-bucket --bucket <span class=s2>&#34;</span><span class=si>${</span><span class=nv>S3_BUCKET_NAME</span><span class=si>}</span><span class=s2>&#34;</span> --region <span class=s2>&#34;</span><span class=si>${</span><span class=nv>S3_REGION</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>If you want to set up Milvus for RAG, please create another S3 bucket for Milvus:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Please change the bucket name to something else.</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>MILVUS_S3_BUCKET_NAME</span><span class=o>=</span><span class=s2>&#34;llmariner-demo-milvus&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>aws s3api create-bucket --bucket <span class=s2>&#34;</span><span class=si>${</span><span class=nv>MILVUS_S3_BUCKET_NAME</span><span class=si>}</span><span class=s2>&#34;</span> --region <span class=s2>&#34;</span><span class=si>${</span><span class=nv>S3_REGION</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span></code></pre></div><p>Pods running in the EKS cluster need to be able to access the S3 bucket. We will create an <a href=https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html>IAM role for service account</a> for that.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat <span class=s>&lt;&lt; EOF | envsubst &gt; policy.json
</span></span></span><span class=line><span class=cl><span class=s>{
</span></span></span><span class=line><span class=cl><span class=s>  &#34;Version&#34;: &#34;2012-10-17&#34;,
</span></span></span><span class=line><span class=cl><span class=s>  &#34;Statement&#34;: [
</span></span></span><span class=line><span class=cl><span class=s>    {
</span></span></span><span class=line><span class=cl><span class=s>      &#34;Effect&#34;: &#34;Allow&#34;,
</span></span></span><span class=line><span class=cl><span class=s>      &#34;Action&#34;: [
</span></span></span><span class=line><span class=cl><span class=s>        &#34;s3:PutObject&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;s3:GetObject&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;s3:DeleteObject&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;s3:ListBucket&#34;
</span></span></span><span class=line><span class=cl><span class=s>      ],
</span></span></span><span class=line><span class=cl><span class=s>      &#34;Resource&#34;: [
</span></span></span><span class=line><span class=cl><span class=s>        &#34;arn:aws:s3:::${S3_BUCKET_NAME}/*&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;arn:aws:s3:::${S3_BUCKET_NAME}&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;arn:aws:s3:::${MILVUS_S3_BUCKET_NAME}/*&#34;,
</span></span></span><span class=line><span class=cl><span class=s>        &#34;arn:aws:s3:::${MILVUS_S3_BUCKET_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>      ]
</span></span></span><span class=line><span class=cl><span class=s>    }
</span></span></span><span class=line><span class=cl><span class=s>  ]
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LLMARINER_POLICY</span><span class=o>=</span><span class=s2>&#34;LLMarinerPolicy&#34;</span>
</span></span><span class=line><span class=cl>aws iam create-policy --policy-name <span class=s2>&#34;</span><span class=si>${</span><span class=nv>LLMARINER_POLICY</span><span class=si>}</span><span class=s2>&#34;</span> --policy-document file://policy.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>LLMARINER_SERVICR_ACCOUNT_NAME</span><span class=o>=</span><span class=s2>&#34;llmariner&#34;</span>
</span></span><span class=line><span class=cl>eksctl create iamserviceaccount <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --name <span class=s2>&#34;</span><span class=si>${</span><span class=nv>LLMARINER_SERVICR_ACCOUNT_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace <span class=s2>&#34;</span><span class=si>${</span><span class=nv>LLMARINER_NAMESPACE</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --cluster <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --role-name <span class=s2>&#34;LLMarinerRole&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --attach-policy-arn <span class=s2>&#34;arn:aws:iam::</span><span class=si>${</span><span class=nv>AWS_ACCOUNT_ID</span><span class=si>}</span><span class=s2>:policy/</span><span class=si>${</span><span class=nv>LLMARINER_POLICY</span><span class=si>}</span><span class=s2>&#34;</span> --approve
</span></span></code></pre></div><h3 id=step-4-install-milvus>Step 4. Install Milvus<a class=td-heading-self-link href=#step-4-install-milvus aria-label="Heading self-link"></a></h3><p>Install <a href=https://milvus.io/>Milvus</a> as it is used a backend vector database for RAG.</p><p>Milvus creates Persistent Volumes. Follow <a href=https://docs.aws.amazon.com/eks/latest/userguide/ebs-csi.html>https://docs.aws.amazon.com/eks/latest/userguide/ebs-csi.html</a> and install EBS CSI driver.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>eksctl create iamserviceaccount <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --name ebs-csi-controller-sa <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace kube-system <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --cluster <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --role-name AmazonEKS_EBS_CSI_DriverRole <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --role-only <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --attach-policy-arn arn:aws:iam::aws:policy/service-role/AmazonEBSCSIDriverPolicy <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --approve
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>eksctl create addon <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --cluster <span class=s2>&#34;</span><span class=si>${</span><span class=nv>CLUSTER_NAME</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --name aws-ebs-csi-driver <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --version latest <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --service-account-role-arn <span class=s2>&#34;arn:aws:iam::</span><span class=si>${</span><span class=nv>AWS_ACCOUNT_ID</span><span class=si>}</span><span class=s2>:role/AmazonEKS_EBS_CSI_DriverRole&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --force
</span></span></code></pre></div><p>Then install the Helm chart. Milvus requires access to the S3 bucket. To use the same service account created above, we deploy Milvus in the same namespace as LLMariner.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat <span class=s>&lt;&lt; EOF | envsubst &gt; milvus-values.yaml
</span></span></span><span class=line><span class=cl><span class=s>cluster:
</span></span></span><span class=line><span class=cl><span class=s>  enabled: false
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>etcd:
</span></span></span><span class=line><span class=cl><span class=s>  replicaCount: 1
</span></span></span><span class=line><span class=cl><span class=s>  persistence:
</span></span></span><span class=line><span class=cl><span class=s>    storageClass: gp2 # Use gp3 if available
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>pulsar:
</span></span></span><span class=line><span class=cl><span class=s>  enabled: false
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>minio:
</span></span></span><span class=line><span class=cl><span class=s>  enabled: false
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>standalone:
</span></span></span><span class=line><span class=cl><span class=s>  persistence:
</span></span></span><span class=line><span class=cl><span class=s>    persistentVolumeClaim:
</span></span></span><span class=line><span class=cl><span class=s>      storageClass: gp2 # Use gp3 if available
</span></span></span><span class=line><span class=cl><span class=s>      size: 10Gi
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>serviceAccount:
</span></span></span><span class=line><span class=cl><span class=s>  create: false
</span></span></span><span class=line><span class=cl><span class=s>  name: &#34;${LLMARINER_SERVICR_ACCOUNT_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>externalS3:
</span></span></span><span class=line><span class=cl><span class=s>  enabled: true
</span></span></span><span class=line><span class=cl><span class=s>  host: s3.us-east-1.amazonaws.com
</span></span></span><span class=line><span class=cl><span class=s>  port: 443
</span></span></span><span class=line><span class=cl><span class=s>  useSSL: true
</span></span></span><span class=line><span class=cl><span class=s>  bucketName: &#34;${MILVUS_S3_BUCKET_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  useIAM: true
</span></span></span><span class=line><span class=cl><span class=s>  cloudProvider: aws
</span></span></span><span class=line><span class=cl><span class=s>  iamEndpoint: &#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s>  logLevel: info
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm repo add zilliztech https://zilliztech.github.io/milvus-helm/
</span></span><span class=line><span class=cl>helm repo update
</span></span><span class=line><span class=cl>helm upgrade --install --wait <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace <span class=s2>&#34;</span><span class=si>${</span><span class=nv>LLMARINER_NAMESPACE</span><span class=si>}</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  milvus zilliztech/milvus <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f milvus-values.yaml
</span></span></code></pre></div><p>Please see the <a href=https://milvus.io/docs/install-overview.md>Milvus installation document</a> and the <a href=https://artifacthub.io/packages/helm/milvus/milvus>Helm chart</a> for other installation options.</p><h3 id=step-5-install-llmariner>Step 5. Install LLMariner<a class=td-heading-self-link href=#step-5-install-llmariner aria-label="Heading self-link"></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Set the endpoint URL of LLMariner. Please change if you are using a different ingress controller.</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>INGRESS_CONTROLLER_URL</span><span class=o>=</span>http://<span class=k>$(</span>kubectl get services -n kong kong-proxy-kong-proxy  -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s1>&#39;{.status.loadBalancer.ingress[0].hostname}&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt; EOF | envsubst &gt; llmariner-values.yaml
</span></span></span><span class=line><span class=cl><span class=s>global:
</span></span></span><span class=line><span class=cl><span class=s>  # This is an ingress configuration with Kong. Please change if you are using a different ingress controller.
</span></span></span><span class=line><span class=cl><span class=s>  ingress:
</span></span></span><span class=line><span class=cl><span class=s>    ingressClassName: kong
</span></span></span><span class=line><span class=cl><span class=s>    # The URL of the ingress controller. this can be a port-forwarding URL (e.g., http://localhost:8080) if there is
</span></span></span><span class=line><span class=cl><span class=s>    # no URL that is reachable from the outside of the EKS cluster.
</span></span></span><span class=line><span class=cl><span class=s>    controllerUrl: &#34;${INGRESS_CONTROLLER_URL}&#34;
</span></span></span><span class=line><span class=cl><span class=s>    annotations:
</span></span></span><span class=line><span class=cl><span class=s>      # To remove the buffering from the streaming output of chat completion.
</span></span></span><span class=line><span class=cl><span class=s>      konghq.com/response-buffering: &#34;false&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>  database:
</span></span></span><span class=line><span class=cl><span class=s>    host: &#34;${POSTGRES_ADDR}&#34;
</span></span></span><span class=line><span class=cl><span class=s>    port: ${POSTGRES_PORT}
</span></span></span><span class=line><span class=cl><span class=s>    username: &#34;${POSTGRES_USER}&#34;
</span></span></span><span class=line><span class=cl><span class=s>    ssl:
</span></span></span><span class=line><span class=cl><span class=s>      mode: require
</span></span></span><span class=line><span class=cl><span class=s>    createDatabase: true
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>  databaseSecret:
</span></span></span><span class=line><span class=cl><span class=s>    name: &#34;${POSTGRES_SECRET_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>    key: password
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>  objectStore:
</span></span></span><span class=line><span class=cl><span class=s>    s3:
</span></span></span><span class=line><span class=cl><span class=s>      bucket: &#34;${S3_BUCKET_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>      region: &#34;${S3_REGION}&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>file-manager-server:
</span></span></span><span class=line><span class=cl><span class=s>  serviceAccount:
</span></span></span><span class=line><span class=cl><span class=s>    create: false
</span></span></span><span class=line><span class=cl><span class=s>    name: &#34;${LLMARINER_SERVICE_ACCOUNT_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>inference-manager-engine:
</span></span></span><span class=line><span class=cl><span class=s>  serviceAccount:
</span></span></span><span class=line><span class=cl><span class=s>    create: false
</span></span></span><span class=line><span class=cl><span class=s>    name: &#34;${LLMARINER_SERVICE_ACCOUNT_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  model:
</span></span></span><span class=line><span class=cl><span class=s>    default:
</span></span></span><span class=line><span class=cl><span class=s>      runtimeName: vllm
</span></span></span><span class=line><span class=cl><span class=s>      preloaded: true
</span></span></span><span class=line><span class=cl><span class=s>      resources:
</span></span></span><span class=line><span class=cl><span class=s>        limits:
</span></span></span><span class=line><span class=cl><span class=s>          nvidia.com/gpu: 1
</span></span></span><span class=line><span class=cl><span class=s>    overrides:
</span></span></span><span class=line><span class=cl><span class=s>      meta-llama/Meta-Llama-3.1-8B-Instruct-q4_0:
</span></span></span><span class=line><span class=cl><span class=s>        contextLength: 16384
</span></span></span><span class=line><span class=cl><span class=s>      google/gemma-2b-it-q4_0:
</span></span></span><span class=line><span class=cl><span class=s>        runtimeName: ollama
</span></span></span><span class=line><span class=cl><span class=s>        resources:
</span></span></span><span class=line><span class=cl><span class=s>         limits:
</span></span></span><span class=line><span class=cl><span class=s>           nvidia.com/gpu: 0
</span></span></span><span class=line><span class=cl><span class=s>      sentence-transformers/all-MiniLM-L6-v2-f16:
</span></span></span><span class=line><span class=cl><span class=s>        runtimeName: ollama
</span></span></span><span class=line><span class=cl><span class=s>        resources:
</span></span></span><span class=line><span class=cl><span class=s>         limits:
</span></span></span><span class=line><span class=cl><span class=s>           nvidia.com/gpu: 0
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>inference-manager-server:
</span></span></span><span class=line><span class=cl><span class=s>  service:
</span></span></span><span class=line><span class=cl><span class=s>    annotations:
</span></span></span><span class=line><span class=cl><span class=s>      # These annotations are only meaningful for Kong ingress controller to extend the timeout.
</span></span></span><span class=line><span class=cl><span class=s>      konghq.com/connect-timeout: &#34;360000&#34;
</span></span></span><span class=line><span class=cl><span class=s>      konghq.com/read-timeout: &#34;360000&#34;
</span></span></span><span class=line><span class=cl><span class=s>      konghq.com/write-timeout: &#34;360000&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>job-manager-dispatcher:
</span></span></span><span class=line><span class=cl><span class=s>  serviceAccount:
</span></span></span><span class=line><span class=cl><span class=s>    create: false
</span></span></span><span class=line><span class=cl><span class=s>    name: &#34;${LLMARINER_SERVICE_ACCOUNT_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  notebook:
</span></span></span><span class=line><span class=cl><span class=s>    # Used to set the base URL of the API endpoint. This can be same as global.ingress.controllerUrl
</span></span></span><span class=line><span class=cl><span class=s>    # if the URL is reachable from the inside cluster. Otherwise you can change this to the
</span></span></span><span class=line><span class=cl><span class=s>    # to the URL of the ingress controller that is reachable inside the K8s cluster.
</span></span></span><span class=line><span class=cl><span class=s>    llmarinerBaseUrl: &#34;${INGRESS_CONTROLLER_URL}&#34;/v1
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>model-manager-loader:
</span></span></span><span class=line><span class=cl><span class=s>  serviceAccount:
</span></span></span><span class=line><span class=cl><span class=s>    create: false
</span></span></span><span class=line><span class=cl><span class=s>    name: &#34;${LLMARINER_SERVICE_ACCOUNT_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  baseModels:
</span></span></span><span class=line><span class=cl><span class=s>  - meta-llama/Meta-Llama-3.1-8B-Instruct-q4_0
</span></span></span><span class=line><span class=cl><span class=s>  - google/gemma-2b-it-q4_0
</span></span></span><span class=line><span class=cl><span class=s>  - sentence-transformers/all-MiniLM-L6-v2-f16
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Required when RAG is used.
</span></span></span><span class=line><span class=cl><span class=s>vector-store-manager-server:
</span></span></span><span class=line><span class=cl><span class=s>  serviceAccount:
</span></span></span><span class=line><span class=cl><span class=s>    create: false
</span></span></span><span class=line><span class=cl><span class=s>    name: &#34;${LLMARINER_SERVICE_ACCOUNT_NAME}&#34;
</span></span></span><span class=line><span class=cl><span class=s>  vectorDatabase:
</span></span></span><span class=line><span class=cl><span class=s>    host: milvus
</span></span></span><span class=line><span class=cl><span class=s>  llmEngineAddr: ollama-sentence-transformers-all-minilm-l6-v2-f16:11434
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm upgrade --install <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace llmariner <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  llmariner oci://public.ecr.aws/cloudnatix/llmariner-charts/llmariner <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f llmariner-values.yaml
</span></span></code></pre></div><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>Starting from Helm v3.8.0, the OCI registry is supported by default. If you are using an older version, please upgrade to v3.8.0 or later. For more details, please refer to <a href=https://helm.sh/docs/topics/registries/>Helm OCI-based registries</a>.</div><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>If you are getting a 403 forbidden error, please try <code>docker logout public.ecr.aws</code>. Please see <a href=https://docs.aws.amazon.com/AmazonECR/latest/public/public-troubleshooting.html>AWS document</a> for more details.</div><p>If you would like to install only the control-plane components or the worker-plane components, please see <code>multi_cluster_deployment</code>{.interpreted-text role=&ldquo;doc&rdquo;}.</p><h3 id=step-6-verify-the-installation>Step 6. Verify the installation<a class=td-heading-self-link href=#step-6-verify-the-installation aria-label="Heading self-link"></a></h3><p>You can verify the installation by sending sample chat completion requests.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;This is your endpoint URL: </span><span class=si>${</span><span class=nv>INGRESS_CONTROLLER_URL</span><span class=si>}</span><span class=s2>/v1&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>llma auth login
</span></span><span class=line><span class=cl><span class=c1># Type the above endpoint URL.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>llma models list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>llma chat completions create --model google-gemma-2b-it-q4_0 --role user --completion <span class=s2>&#34;what is k8s?&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>llma chat completions create --model meta-llama-Meta-Llama-3.1-8B-Instruct-q4_0 --role user --completion <span class=s2>&#34;hello&#34;</span>
</span></span></code></pre></div><h3 id=optional-monitor-gpu-utilization>Optional: Monitor GPU utilization<a class=td-heading-self-link href=#optional-monitor-gpu-utilization aria-label="Heading self-link"></a></h3><p>If you would like to install Prometheus and Grafana to see GPU utilization, run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Add Prometheus</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; prom-scrape-configs.yaml
</span></span></span><span class=line><span class=cl><span class=s>- job_name: nvidia-dcgm
</span></span></span><span class=line><span class=cl><span class=s>  scrape_interval: 5s
</span></span></span><span class=line><span class=cl><span class=s>  static_configs:
</span></span></span><span class=line><span class=cl><span class=s>  - targets: [&#39;nvidia-dcgm-exporter.nvidia.svc:9400&#39;]
</span></span></span><span class=line><span class=cl><span class=s>- job_name: inference-manager-engine-metrics
</span></span></span><span class=line><span class=cl><span class=s>  scrape_interval: 5s
</span></span></span><span class=line><span class=cl><span class=s>  static_configs:
</span></span></span><span class=line><span class=cl><span class=s>  - targets: [&#39;inference-manager-server-http.llmariner.svc:8083&#39;]
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
</span></span><span class=line><span class=cl>helm repo update
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm upgrade --install --wait <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace monitoring <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set-file <span class=nv>extraScrapeConfigs</span><span class=o>=</span>prom-scrape-configs.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  prometheus prometheus-community/prometheus
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add Grafana with DCGM dashboard</span>
</span></span><span class=line><span class=cl>cat <span class=s>&lt;&lt;EOF &gt; grafana-values.yaml
</span></span></span><span class=line><span class=cl><span class=s>datasources:
</span></span></span><span class=line><span class=cl><span class=s> datasources.yaml:
</span></span></span><span class=line><span class=cl><span class=s>   apiVersion: 1
</span></span></span><span class=line><span class=cl><span class=s>   datasources:
</span></span></span><span class=line><span class=cl><span class=s>   - name: Prometheus
</span></span></span><span class=line><span class=cl><span class=s>     type: prometheus
</span></span></span><span class=line><span class=cl><span class=s>     url: http://prometheus-server
</span></span></span><span class=line><span class=cl><span class=s>     isDefault: true
</span></span></span><span class=line><span class=cl><span class=s>dashboardProviders:
</span></span></span><span class=line><span class=cl><span class=s>  dashboardproviders.yaml:
</span></span></span><span class=line><span class=cl><span class=s>    apiVersion: 1
</span></span></span><span class=line><span class=cl><span class=s>    providers:
</span></span></span><span class=line><span class=cl><span class=s>    - name: &#39;default&#39;
</span></span></span><span class=line><span class=cl><span class=s>      orgId: 1
</span></span></span><span class=line><span class=cl><span class=s>      folder: &#39;default&#39;
</span></span></span><span class=line><span class=cl><span class=s>      type: file
</span></span></span><span class=line><span class=cl><span class=s>      disableDeletion: true
</span></span></span><span class=line><span class=cl><span class=s>      editable: true
</span></span></span><span class=line><span class=cl><span class=s>      options:
</span></span></span><span class=line><span class=cl><span class=s>        path: /var/lib/grafana/dashboards/standard
</span></span></span><span class=line><span class=cl><span class=s>dashboards:
</span></span></span><span class=line><span class=cl><span class=s>  default:
</span></span></span><span class=line><span class=cl><span class=s>    nvidia-dcgm-exporter:
</span></span></span><span class=line><span class=cl><span class=s>      gnetId: 12239
</span></span></span><span class=line><span class=cl><span class=s>      datasource: Prometheus
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>helm repo add grafana https://grafana.github.io/helm-charts
</span></span><span class=line><span class=cl>helm repo update
</span></span><span class=line><span class=cl>helm upgrade --install --wait <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace monitoring <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f grafana-values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  grafana grafana/grafana
</span></span></code></pre></div><h3 id=optional-enable-tls>Optional: Enable TLS<a class=td-heading-self-link href=#optional-enable-tls aria-label="Heading self-link"></a></h3><p>First follow the <a href=https://cert-manager.io/Doc/>Cert Manager installation document</a> and install Cert Manager to your K8s cluster if you don't have one. Then create a <code>ClusterIssuer</code> for your domain. Here is an example manifest that uses Let's Encrypt.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>cert-manager.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ClusterIssuer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>letsencrypt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>acme</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class=l>https://acme-v02.api.letsencrypt.org/directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>email</span><span class=p>:</span><span class=w> </span><span class=l>user@mydomain.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>privateKeySecretRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>letsencrypt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>solvers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>http01</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nt>ingress</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ingressClassName</span><span class=p>:</span><span class=w> </span><span class=l>kong</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>dnsZones</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>llm.mydomain.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>dns01</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=l>...</span><span class=w>
</span></span></span></code></pre></div><p>Then you can add the following to <code>values.yaml</code> of LLMariner to enable TLS.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>global</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ingress</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cert-manager.io/cluster-issuer</span><span class=p>:</span><span class=w> </span><span class=l>letsencrypt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>tls</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>api.llm.mydomain.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class=l>api-tls</span><span class=w>
</span></span></span></code></pre></div><p>The ingresses created from the Helm chart will have the following annotation and spec:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>networking.k8s.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cert-manager.io/cluster-issuer</span><span class=p>:</span><span class=w> </span><span class=l>letsencrypt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>tls</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>api.llm.mydomain.com</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class=l>api-tls</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>...</span><span class=w>
</span></span></span></code></pre></div><div class=td-page-meta__lastmod>Last modified October 25, 2024: <a href=https://github.com/llmariner/llmariner.github.io/commit/822f4ddbbe0e3e2852cf7b873fc1f118b0502797>docs: add a CLI installation method using Go and integrate source text (#43) (822f4dd)</a></div></div></main></div></div><footer class="td-footer row d-print-none"><div class=container-fluid><div class="row mx-md-2"><div class="td-footer__left col-6 col-sm-4 order-sm-1"></div><div class="td-footer__right col-6 col-sm-4 order-sm-3"><ul class=td-footer__links-list><li class=td-footer__links-item data-bs-toggle=tooltip title=GitHub aria-label=GitHub><a target=_blank rel=noopener href=https://github.com/llmariner/llmariner aria-label=GitHub><i class="fab fa-github"></i></a></li><li class=td-footer__links-item data-bs-toggle=tooltip title=Slack aria-label=Slack><a target=_blank rel=noopener href=https://join.slack.com/t/llmariner/shared_invite/zt-2rbwooslc-LIrUCmK9kklfKsMEirUZbg aria-label=Slack><i class="fab fa-slack"></i></a></li></ul></div><div class="td-footer__center col-12 col-sm-4 py-2 order-sm-2"><span class=td-footer__copyright>&copy;
2024
<span class=td-footer__authors>CloudNatix, Inc.</span></span><span class=td-footer__all_rights_reserved>All Rights Reserved</span></div></div></div></footer></div><script src=/js/main.min.f72d00502781aaf278a14088eb2356b1ba2a05ad698a0c43fe86314d74ceab56.js integrity="sha256-9y0AUCeBqvJ4oUCI6yNWsboqBa1pigxD/oYxTXTOq1Y=" crossorigin=anonymous></script><script defer src=/js/click-to-copy.min.73478a7d4807698aed7e355eb23f9890ca18fea3158604c8471746d046702bad.js integrity="sha256-c0eKfUgHaYrtfjVesj+YkMoY/qMVhgTIRxdG0EZwK60=" crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script></body></html>